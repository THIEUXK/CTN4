
@model X.PagedList.IPagedList<CTN4_Data.Models.DB_CTN4.KhuyenMai>

@using X.PagedList.Mvc.Core
@{
    ViewData["Title"] = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
    var itemIds = new List<string>();
    

}

<div class="row ">
    <div class="card">
        <div class="card-body">
            <br><br />

            <div class="row no-gutters pb-4">
                <div class="col align-items-center d-flex">
                    <h3 class="title-page"><strong>Danh sách khuyến mãi</strong></h3>
                    </div>
                    <div class="col-auto pl-3">
                        <div class="d-flex">
                            <div>
                                <button type="button" class="btn btn-primary fix-height--button cursor-pointer editable-click=" asp-action="Create" fdprocessedid="c7i21y">
                                    <a asp-action="Create" style="color:white"><i class="fas fa-plus-circle" style="color:white"></i>Tạo khuyến mãi</a>
                                </button>
                            </div>
                        </div>
                </div>
            </div>
            


            
                                                               <!-- Nav tabs -->
            <ul class="nav nav-tabs" style="margin-bottom: 10px">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#home"onclick="loadTabContent('Index')">Tất cả khuyến mãi</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#menu1" onclick="loadTabContent('GetActiveKhuyenMai')">Đang hoạt động</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#menu2" onclick="loadTabContent('GetInactiveKhuyenMai')">Chưa kích hoạt</a>
                </li>
            </ul>

            
                                                             <!--Lọc và tìm kiếm-->
            
            <div class="input-group" style="margin-bottom: 20px">
                <div class="dropdown me-1">
                    <button type="button" class="btn btn-outline-dark dropdown-toggle" style="border-radius: 5px; margin-right: 10px">
                        <i class="fas fa-filter">  Thêm điều kiện lọc  </i>
                    </button>
                    <ul class="dropdown-menu">
                        <li>
                            <a class="dropdown-item" href="@Url.Action("Index")">Tất cả các mã</a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="@Url.Action("SoTienGiam")">Theo giá tiền</a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="@Url.Action("PhanTramGiam")">Theo phần trăm giảm</a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="@Url.Action("DongGia")">Theo đồng giá</a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="@Url.Action("Mua1Tang1")">Mua 1 tặng 1</a>
                        </li>
                    </ul>
                </div>
                <form method="get" style="display:flex">
                    <div class="form-outline">
                        <input type="text" id="form1" class="form-control" name="searchString" style="width: 680px" placeholder="Tìm kiếm..." />
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
                
            </div>
            @*
                    <form>
                        <div class="custom-control custom-switch">
                            <input type="checkbox" class="custom-control-input" id="switch1">
                            <label class="custom-control-label" for="switch1">Toggle me</label>
                        </div>
                    </form> 

              *@

                                                             <!-- Tab panes -->
            <div class="tab-content">

                <div id="home" class="container-fluid tab-pane fade show active"><br>
                    <table class="table table-bordered">
                        <thead class="thead-dark" >
                            <tr>
                                <th>
                                    <h6 style="color:white; text-align:center;">Mã khuyến mãi</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Loại khuyến mãi</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Số tiền giảm/ % giảm</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Ngày bắt đầu</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Ngày kết thúc</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center; white-space:nowrap">Ghi chú</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Trạng thái</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Nút</h6>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                itemIds.Add(item.Id.ToString());
                                <tr>
                                    <td>
                                        <h6 style="text-align:center">@item.MaKhuyenMai</h6>
                                    </td>
                                    @if(@item.DongGia !=0) {
                                        <td>
                                            <h6 style="text-align:center">Đồng giá</h6>
                                        </td>
                                        <td>
                                            <h6 style="text-align:center">@FormatCurrency(item.DongGia) </h6>
                                        </td>
                                    }
                                    @if(@item.PhanTramGiamGia !=0) {
                                        <td>
                                            <h6 style="text-align:center">Giảm %</h6>
                                        </td>
                                        <td>
                                            <h6 style="text-align:center">@item.PhanTramGiamGia % </h6>
                                        </td>
                                    }
                                    @if(@item.SoTienGiam !=0) {
                                        <td>
                                            <h6 style="text-align:center">Giảm số tiền</h6>
                                        </td>
                                        <td>
                                            <h6 style="text-align:center">@FormatCurrency(item.SoTienGiam) </h6>
                                        </td>
                                    }
                                    @if(item.Mua1tang1 == true)
                                    {
                                        <td>
                                            <h6 style="text-align:center">Mua 1 tặng 1</h6>
                                        </td>
                                        <td>
                                            <h6 style="text-align:center">@FormatCurrency(0) </h6>
                                        </td>
                                    }
                                    @if(@item.SoTienGiam == 0 && @item.PhanTramGiamGia == 0 && @item.DongGia == 0 && item.Mua1tang1 != true) {
                                        <td>
                                            <h6 style="text-align:center">null</h6>
                                        </td>
                                        <td>
                                            <h6 style="text-align:center">null </h6>
                                        </td>
                                    }

                                    
                                    <td>
                                        <h6 type="datetime-local" style="text-align:center">
                                        <input type="datetime-local" value="@item.NgayBatDau.ToString("yyyy-MM-ddTHH:mm")" style="width:175px" readonly>
                                        </h6>
                                    </td>
                                    <td>
                                        <h6 style="text-align:center">
                                        <input type="datetime-local" value="@item.NgayKetThuc.ToString("yyyy-MM-ddTHH:mm")" style="width:175px" readonly></h6>
                                    </td><td>
                                        <h6 style="text-align:center">@item.Ghichu</h6>
                                    </td>
                                    @if(item.NgayKetThuc >= DateTime.Now)
                                    {
                                        @if (item.TrangThai != false && item.NgayBatDau <= DateTime.Now)
                                        {
                                            <td class="border-bottom-0">
                                                <p class="mb-0 fw-normal" style="white-space: nowrap; color:white;text-align :center; background-color: forestgreen; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Đang khuyến mãi</p>
                                            </td>
                                        }
                                        else
                                        {
                                            <td class="border-bottom-0">
                                                <p class="mb-0 fw-normal"  style="white-space: nowrap; color:white;text-align :center; background-color: orange; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Chưa kích hoạt</p>
                                            </td>
                                        }
                                    }
                                    else
                                    {
                                       
                                        <td class="border-bottom-0">
                                            @using (Html.BeginForm("UpdateProductStatus", "KhuyenMai", FormMethod.Post))
                                            {
                                               
                                            }
                                                <p class="mb-0 fw-normal"  style="white-space: nowrap; color:white;text-align :center; background-color: red; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Đã hết hạn</p>
                                            </td>
                                    }

                                    <td>
                                        @if (item.NgayKetThuc > DateTime.Now && item.NgayBatDau <= DateTime.Now)
                                        {
                                            <button type="button" class="custom-button" style="white-space: nowrap; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                                @Html.ActionLink("Chọn sp", "Edit", new { id = item.Id })
                                            </button>
                                        }
                                        
                                        @*<button type="button" style="white-space: nowrap; background-color: wheat; border-color:deepskyblue; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                            @Html.ActionLink( "Thông tin","Details", new { id=item.Id })
                                        </button>*@
                                        <button type="button" class="custom-button" style="white-space: nowrap; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                            @Html.ActionLink("Xóa", "Delete", new { id = item.Id }, new { style = "text-decoration: none;", @class="custom-text-color", onclick = "return confirmDelete();" })
                                        </button>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    <div class="row no-gutters justify-content-between paginate">
                        <div class="col-auto ">
                            <div class="row no-gutters align-items-center">
                                @using (Html.BeginForm("Index", "KhuyenMai", FormMethod.Get))
                                {
                                    <div class="custom-dropdown">
                                        Kích thước trang: @Html.DropDownList("size", (List<SelectListItem>)ViewBag.size, new { @onchange = "this.form.submit();" })
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="col-auto">
                            <div class="row no-gutters align-items-center">
                                <div class="col-auto mr-3">
                                    <span style="color: rgb(128, 128, 128);">Tổng:<span id="id">@Model.Count()</span></span>
                                </div>
                                <div class="col">
                                    <div class="pagination-container">
                                        <ul class="pagination">
                                           @if (Model.HasPreviousPage)
                                           {
                                               <li class="page-item">
                                                   <a class="page-link" href="@Url.Action("Index", new { page = Model.PageNumber - 1, size = ViewBag.currentSize })">Previous</a>
                                               </li>
                                           }

                                            @for (var i = 1; i <= Model.PageCount; i++)
                                            {
                                                <li class="page-item @(i == Model.PageNumber ? "active" : "")">
                                                    <a class="page-link" href="@Url.Action("Index", new { page = i, size = ViewBag.currentSize })">@i</a>
                                                </li>
                                            }

                                            @if (Model.HasNextPage)
                                            {
                                                <li class="page-item">
                                                    <a class="page-link" href="@Url.Action("Index", new { page = Model.PageNumber + 1, size = ViewBag.currentSize })">Next</a>
                                                </li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="menu1" class="container-fluid tab-pane fade"><br>
                    <table class="table table-bordered">
                        <thead class="thead-dark" >
                            <tr>
                                <th>
                                    <h6 style="color:white; text-align:center;">Mã khuyến mãi</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Loại khuyến mãi</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Số tiền giảm/ % giảm</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Ngày bắt đầu</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Ngày kết thúc</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center; white-space:nowrap">Ghi chú</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Trạng thái</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Hành động</h6>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Where(item => item.TrangThai == true && item.NgayKetThuc >= DateTime.Now && item.NgayBatDau < DateTime.Now))
                            {
                                itemIds.Add(item.Id.ToString());
                                @if(item.TrangThai == true && item.NgayKetThuc >= DateTime.Now && item.NgayBatDau < DateTime.Now)
                                {
                                    <tr>
                                        <td>
                                            <h6 style="text-align:center">@item.MaKhuyenMai</h6>
                                        </td>
                                        @if(@item.DongGia !=0) {
                                            <td>
                                                <h6 style="text-align:center">Đồng giá</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">@FormatCurrency(item.DongGia) </h6>
                                            </td>
                                        }
                                        @if(@item.PhanTramGiamGia !=0) {
                                            <td>
                                                <h6 style="text-align:center">Giảm %</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">@item.PhanTramGiamGia % </h6>
                                            </td>
                                        }
                                        @if(@item.SoTienGiam !=0) {
                                            <td>
                                                <h6 style="text-align:center">Giảm số tiền</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">@FormatCurrency(item.SoTienGiam) </h6>
                                            </td>
                                        }
                                        @if(@item.SoTienGiam == 0 && @item.PhanTramGiamGia == 0 && @item.DongGia == 0) {
                                            <td>
                                                <h6 style="text-align:center">null</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">null </h6>
                                            </td>
                                        }

                                    
                                        <td>
                                            <h6 type="datetime-local" style="text-align:center">
                                            <input type="datetime-local" value="@item.NgayBatDau.ToString("yyyy-MM-ddTHH:mm")" style="width:175px" readonly>
                                            </h6>
                                        </td>
                                        <td>
                                            <h6 style="text-align:center">
                                            <input type="datetime-local" value="@item.NgayBatDau.ToString("yyyy-MM-ddTHH:mm")" style="width:175px" readonly></h6>
                                        </td><td>
                                            <h6 style="text-align:center">@item.Ghichu</h6>
                                        </td>
                                        @if (item.NgayKetThuc >= DateTime.Now)
                                        {
                                            @if (item.TrangThai != false && item.NgayBatDau <= DateTime.Now)
                                            {
                                                <td class="border-bottom-0">
                                                    <p class="mb-0 fw-normal" style="white-space: nowrap; color:white;text-align :center; background-color: forestgreen; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Đang khuyến mãi</p>
                                                </td>
                                            }
                                            else
                                            {
                                                <td class="border-bottom-0">
                                                    <p class="mb-0 fw-normal" style="white-space: nowrap; color:white;text-align :center; background-color: orange; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Chưa kích hoạt</p>
                                                </td>
                                            }
                                        }
                                        else
                                        {

                                            <td class="border-bottom-0">
                                                @using (Html.BeginForm("UpdateProductStatus", "KhuyenMai", FormMethod.Post))
                                                {

                                                }
                                                <p class="mb-0 fw-normal" style="white-space: nowrap; color:white;text-align :center; background-color: red; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Đã hết hạn</p>
                                            </td>
                                        }

                                        <td>
                                            @if (item.NgayKetThuc > DateTime.Now && item.NgayBatDau <= DateTime.Now)
                                            {
                                                <button type="button" class="custom-button" style="white-space: nowrap; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                                    @Html.ActionLink("Chọn sp", "Edit", new { id = item.Id })
                                                </button>
                                            }
                                        
                                            @*<button type="button" style="white-space: nowrap; background-color: wheat; border-color:deepskyblue; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                                @Html.ActionLink( "Thông tin","Details", new { id=item.Id })
                                            </button>*@
                                            <button type="button" class="custom-button" style="white-space: nowrap; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                                @Html.ActionLink("Xóa", "Delete", new { id = item.Id }, new { style = "text-decoration: none;", @class = "custom-text-color", onclick = "return confirmDelete();" })
                                            </button>
                                        </td>
                                    </tr>
                                }
                                else
                                {
                                    <tr><td><p></p></td></tr>
                                }

                            }
                        </tbody>
                    </table>
                </div>
                <div id="menu2" class="container-fluid tab-pane fade"><br>
                    <table class="table table-bordered">
                        <thead class="thead-dark" >
                            <tr>
                                <th>
                                    <h6 style="color:white; text-align:center;">Mã khuyến mãi</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Loại khuyến mãi</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Số tiền giảm/ % giảm</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Ngày bắt đầu</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Ngày kết thúc</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center; white-space:nowrap">Ghi chú</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Trạng thái</h6>
                                </th>
                                <th>
                                    <h6 style="color:white; text-align:center">Trạng thái</h6>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Where(item => (item.TrangThai != true || item.NgayBatDau > DateTime.Now) && item.NgayKetThuc >= DateTime.Now))
                            {
                                itemIds.Add(item.Id.ToString());
                                if((item.TrangThai != true || item.NgayBatDau > DateTime.Now) && item.NgayKetThuc>= DateTime.Now )
                                {
                                    <tr>
                                        <td>
                                            <h6 style="text-align:center">@item.MaKhuyenMai</h6>
                                        </td>
                                        @if(@item.DongGia !=0) {
                                            <td>
                                                <h6 style="text-align:center">Đồng giá</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">@FormatCurrency(item.DongGia) </h6>
                                            </td>
                                        }
                                        @if(@item.PhanTramGiamGia !=0) {
                                            <td>
                                                <h6 style="text-align:center">Giảm %</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">@item.PhanTramGiamGia % </h6>
                                            </td>
                                        }
                                        @if(@item.SoTienGiam !=0) {
                                            <td>
                                                <h6 style="text-align:center">Giảm số tiền</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">@FormatCurrency(item.SoTienGiam) </h6>
                                            </td>
                                        }
                                        @if(@item.SoTienGiam == 0 && @item.PhanTramGiamGia == 0 && @item.DongGia == 0) {
                                            <td>
                                                <h6 style="text-align:center">null</h6>
                                            </td>
                                            <td>
                                                <h6 style="text-align:center">null </h6>
                                            </td>
                                        }

                                    
                                        <td>
                                            <h6 type="datetime-local" style="text-align:center">
                                            <input type="datetime-local" value="@item.NgayBatDau.ToString("yyyy-MM-ddTHH:mm")" style="width:175px" readonly>
                                            </h6>
                                        </td>
                                        <td>
                                            <h6 style="text-align:center">
                                            <input type="datetime-local" value="@item.NgayBatDau.ToString("yyyy-MM-ddTHH:mm")" style="width:175px" readonly></h6>
                                        </td><td>
                                            <h6 style="text-align:center">@item.Ghichu</h6>
                                        </td>
                                        @if (item.NgayKetThuc >= DateTime.Now)
                                        {
                                            @if (item.TrangThai != false && item.NgayBatDau <= DateTime.Now)
                                            {
                                                <td class="border-bottom-0">
                                                    <p class="mb-0 fw-normal" style="white-space: nowrap; color:white;text-align :center; background-color: forestgreen; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Đang khuyến mãi</p>
                                                </td>
                                            }
                                            else
                                            {
                                                <td class="border-bottom-0">
                                                    <p class="mb-0 fw-normal" style="white-space: nowrap; color:white;text-align :center; background-color: orange; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Chưa kích hoạt</p>
                                                </td>
                                            }
                                        }
                                        else
                                        {
                                            <td class="border-bottom-0">
                                                    <p class="mb-0 fw-normal"  style="white-space: nowrap; color:white;text-align :center; background-color: red; line-height: 20px; height: 24px; font-weight: 400; border-style:solid; padding: 0 8px; border-radius:10px; border-width:1px">Đã hết hạn</p>
                                                </td>
                                                @RenderSection("scripts", required: false)

                                        }
                                        <td>
                                            @if (item.NgayKetThuc > DateTime.Now && item.NgayBatDau <= DateTime.Now)
                                            {
                                                <button type="button" class="custom-button" style="white-space: nowrap; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                                    @Html.ActionLink("Chọn sp", "Edit", new { id = item.Id })
                                                </button>
                                            }
                                        
                                            @*<button type="button" style="white-space: nowrap; background-color: wheat; border-color:deepskyblue; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                                @Html.ActionLink( "Thông tin","Details", new { id=item.Id })
                                            </button>*@
                                            <button type="button" class="custom-button" style="white-space: nowrap; border-radius: 10px; font-weight: 400; padding: 0 8px">
                                                @Html.ActionLink("Xóa", "Delete", new { id = item.Id }, new { style = "text-decoration: none;", @class = "custom-text-color", onclick = "return confirmDelete();" })
                                            </button>
                                        </td>
                                    </tr>
                                }
                                else
                                {
                                    <tr><td><p></p></td></tr>
                                }
                            }
                        </tbody>
                      
               
                      
                    </table>
                </div>
            </div>



            
        </div>
    </div>
    <div id="productList"></div>
</div>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>


<script>
    $(document).ready(function () {
        fetchDataFromIndexAction();
        $(window).on('load', function () {
            processItemAndUpdateStatus();
        });
        function processItemAndUpdateStatus() {
    @foreach (var itemId in itemIds)
    {
        <text>
                    // Thực hiện công việc cần thiết với itemId
                    console.log("Processing item with Id: " + '@itemId');

                // Gọi hàm UpdateProductStatus với itemId hoặc thực hiện các thao tác khác
                $.ajax({
                    url: '/admin/KhuyenMai/UpdateProductStatus',
                    type: 'POST',
                    data: { id: '@itemId' },
                    success: function (data) {
                        console.log(data);
                        if (data.success) {
                            // Xử lý khi cập nhật thành công
                            console.log('Product status updated successfully');
                        } else {
                            // Xử lý khi cập nhật không thành công
                            console.log('Failed to update product status');
                        }
                    },
                    error: function () {
                        console.log('Error occurred while updating product status');
                    }
                });
        </text>
    }
        }
    });
    @functions {
        public string FormatCurrency(float price)
        {
            string formattedPrice = string.Format("{0:N0}", price); // Định dạng số và thêm dấu phân cách ngàn
            return formattedPrice + "₫"; // Thêm ký hiệu đồng (₫) vào cuối
        }
    }


    function loadTabContent(action) {
        $.ajax({
            url: '@Url.Action("Index", "KhuyenMai")' + '/' + action,
            type: 'GET',
            success: function (result) {
                $('#' + action).html(result);
            }
        });
    }

    // Initial load for the default active tab
    loadTabContent('Index');
    function formatCurrency(number) {
        return number.toLocaleString('en-US');
    }
    var tableStyle = "border: 1px solid #ddd; border-collapse: collapse; width: 100%;";
    var checkboxStyle = "cursor: pointer;";
    var productList = document.getElementById('productList');
    function fetchDataFromIndexAction() {
        $.ajax({
            url: '/admin/KhuyenMai/GetallKm',
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                console.log(data);

                updateProductList(data); // Update product list
            },
            error: function (error) {
                console.log("Đã xảy ra lỗi: ", error);
            }
        });
    }
    function updateProductList(data) {
        var productListHTML = "<table class='table' style='" + tableStyle + "'>";
        productListHTML += "<thead><tr><th>Mã Sp</th><th>Danh Mục</th><th>Tên Sản Phẩm</th><th>Mã Khuyến Mãi</th><th>Giá Nhập</th><th>Giá bán</th><th>Giá Niêm yết</th><th>Ảnh Đại diện</th></tr></thead>";

        if (data.length > 0) {
            console.log(data);
            productListHTML += "<tbody>" + data.map(item =>
                `<tr>
                            <td>${item.maSp}</td>
                            <td>${item.tenDanhMuc}</td>
                            <td>${item.tenSanPham}</td>
                                    <td>${item.tenKm}</td>
                            <td>${formatCurrency(item.giaNhap)}đ</td>
                            <td>${formatCurrency(item.giaBan)}đ</td>
                            <td>${formatCurrency(item.giaNiemYet)}đ</td>
                            <td><img src='/image/${item.anhDaiDien}' height='100' alt='Product Image'></td>

                        </tr>`
            ).join('') + "</tbody>";
            // <td><input type="checkbox" class="id-sp-button" data-id-sp='${item.id ? item.id : ""}'/></td>
        } else {
            productListHTML += "<tr><td colspan='8'>Không tìm thấy sản phẩm phù hợp</td></tr>";
        }

        productListHTML += "</table>";

        // Set a fixed height and make the table scrollable
        productListHTML = "<div style='height: 300px; overflow-y: auto;'>" + productListHTML + "</div>";

        productList.innerHTML = productListHTML;

        // Add some additional styling to make the table look better
        var table = document.querySelector('.table');
        if (table) {
            table.classList.add('table-bordered', 'table-striped', 'table-hover');
        }

        // Add event listener for the "Select All" checkbox
        var selectAllCheckbox = document.getElementById('selectAllCheckbox');
        if (selectAllCheckbox) {
            selectAllCheckbox.addEventListener('change', function () {
                var checkboxes = document.querySelectorAll('.id-sp-button');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = selectAllCheckbox.checked;

                    // If the checkbox is checked, retrieve the data-id-sp attribute value
                    if (checkbox.checked) {
                        var productId = checkbox.getAttribute('data-id-sp');
                        selectedMaSps.push(productId);
                        console.log("Selected Product ID: " + selectedMaSps);
                        // You can do something with the selected ID here
                    }
                });
            });
        }
    }
    function confirmDelete() {
        var result = confirm("Bạn có chắc chắn muốn Xóa khuyến mãi này không?");
        return result;
    }
</script>

<style>
    .pagination-container {
        display: flex;
        align-items: center;
    }

    .pagination {
        display: flex;
        list-style: none;
        padding: 0;
        margin: 0;
    }

        .pagination li {
            margin: 0;
        }

        .pagination a {
            display: block;
            padding: 8px 12px;
            text-decoration: none;
            color: #333;
            background-color: #fff;
            border: 1px solid #ddd;
            margin-right: 2px;
        }

            .pagination a:hover {
                background-color: #f5f5f5;
            }

        .pagination .active a {
            background-color: #007bff;
            color: #fff;
            border-color: #007bff;
        }

    .page-item {
        margin-right: 5px;
    }

    .page-link {
        color: #007bff;
        text-decoration: none;
        padding: 8px 12px;
        border: 1px solid #ddd;
        background-color: #fff;
        cursor: pointer;
    }

    .page-item.active .page-link {
        background-color: #007bff;
        color: white;
    }

    .page-link:hover {
        background-color: #eee;
    }

    /* Reset some default styles for consistency across browsers */
body, button {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
}

/* Style for the custom button */
.custom-button {
    display: inline-block;
    padding: 10px 20px;
    font-size: 16px;
    text-align: center;
    text-decoration: none;
    cursor: pointer;
    border: 2px solid #3498db;
    border-radius: 5px;
    color: #3498db;
    background-color: #fff;
    transition: background-color 0.3s, color 0.3s;
}

/* Hover effect */
.custom-button:hover {
    background-color: #3498db;
    color: #fff;
}
.custom-text-color{
    color: #3498db;
}
.custom-text-color:hover{
    color: #fff;
}
</style>



<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>



